# Cmfive v2.x requires PHP7.0 and MySQL 5.7
version: '3'

services:
  webapp:
    build:
      context: ./.build/
      dockerfile: DockerfileTake2
    container_name: nginx-php7.2
    volumes:
      - ./:/var/www/html
    ports:
      - "3000:3000"
    network_mode: "host"
    restart: unless-stopped
    working_dir: /var/www/html
  # webapp:
  #   # image: php/7.2-apache
  #   container_name: php-apache
  #   ports:
  #     - "9000:9000"
  #     - "9001:9001"
  #   build:
  #     context: .
  #     dockerfile: ./.build/Dockerfile
  #   volumes:
  #     - ./:/var/www:rw,delegated
  #     # - ./.build/apache/000-default.conf:/etc/apache2/sites-enabled/000-default.conf:rw
  #     - ./.build/certs/:/etc/apache2/ssl/
  #   network_mode: "host"
  #   restart: unless-stopped
  #   working_dir: /var/www

  # app:
  #   build:
  #     context: .
  #     dockerfile: ./.build/Dockerfile
  #   image: digitalocean.com/php
  #   container_name: app
  #   restart: unless-stopped
  #   tty: true
  #   ports:
  #     - "9000:9000"
  #   environment:
  #     SERVICE_NAME: app
  #     SERVICE_TAGS: dev
  #   working_dir: /var/www
  #   volumes:
  #     - ./:/var/www
  #     - ./.build/php/local.ini:/usr/local/etc/php/conf.d/local.ini
  #   # networks:
  #   #   - app-network
  #   network_mode: "host"

  # #Nginx Service
  # webserver:
  #   image: nginx:alpine
  #   container_name: webserver
  #   hostname: "localhost"
  #   restart: unless-stopped
  #   tty: true
  #   ports:
  #     - "9001:9001"
  #     - "9002:9002"
  #   volumes:
  #     - ./:/var/www
  #     - ./.build/nginx/conf.d/:/etc/nginx/conf.d/
  #     - ./.build/certs/:/etc/nginx/certs
  #   # networks:
  #   #   - app-network
  #   network_mode: "host"

  #MySQL Service - uncomment if you need a mysql container
  # db:
  #   image: mysql:5.7.22
  #   container_name: db
  #   restart: unless-stopped
  #   tty: true
  #   ports:
  #     - "3309:3306"
  #   environment:
  #     MYSQL_DATABASE: cmfive
  #     MYSQL_ROOT_PASSWORD: cmfive
  #     SERVICE_TAGS: dev
  #     SERVICE_NAME: mysql
  #   volumes:
  #     - dbdata:/var/lib/mysql
  #     - ./.build/mysql/my.cnf:/etc/mysql/my.cnf
  #   networks: 
  #     - app-network

# Docker Networks
# networks:
#   app-network:
#     driver: bridge

# #Volumes
# volumes:
#   dbdata:
#     driver: local